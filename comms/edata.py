import sysimport smtplibimport imaplibimport getpassfrom static.progressbar import charging, spiner, fillingsquaresfrom static.style import rcolors, rcolorclass Sendsmtp:    def __init__(self, targ):        self.targ = targ    def sendsm(self):        spinerbar = spiner("Connecting")        def prompt(prompt):            return input(prompt).strip()        fromaddr = prompt("From: ")        toaddrs = prompt("To: ").split()        mailnotice = "Enter message, end with ^D (Unix) or ^Z (Windows):"        rcolor(rcolors.blueok, mailnotice)        # Add the From: and To: headers at the start!        msg = ("From: %s\r\nTo: %s\r\n\r\n"               % (fromaddr, ", ".join(toaddrs)))        while True:            try:                line = input()            except EOFError:                break            if not line:                break            msg = msg + line        print("Message length is", len(msg))        chargingbarr = charging("Looking for providers")        host = ['smtp.mail.yahoo.com',                'smtp.office365.com',                'smtp.gmail.com',                'smtp-mail-outlook.com',                'smtp.mail.me.com',                'smtp.aol.com',                ]        def hostarr():            i = 0            hostlen = len(host)            while i < hostlen:                print(i, ': ', host[i])                i += 1        print(hostarr())        hostSelected = int(input("Enter the number corresponding to the host: "))        host = host[hostSelected]        print("Selected Host is:", host)        portSelected = int(input("Enter PostNumber or Press Enter to set a default: ") or "587")        port = portSelected        print("Selected Port is:", port)        password = getpass.getpass('Password: ')        fillingsquaresbarr = fillingsquares("Verifying")        mailnotice = "Password verified"        rcolor(rcolors.blueok, mailnotice)        server = smtplib.SMTP(host, port)        server.starttls()        server.login(fromaddr, password)        server.set_debuglevel(1)        chargingbarr = charging("Sending Data")        server.sendmail(fromaddr, toaddrs, msg)        server.quit()        rcolor(rcolors.blueok, "Success")        print("---------Email sent to {}".format(toaddrs), " ---------->>>")    def imapsm(self):        username = input("Enter User Account: ")        accpass = getpass.getpass("Enter Account Password: ")        user = username        password = accpass        chargingBarr = charging("Looking for providers")        host = ['outlook.office365.com',                'imap.gmail.com',                'imap.mail.me.com',                'imap-mail.outlook.com',                'imap.aol.com',                ]        def hostarr():            i = 0            hostlen = len(host)            while i < hostlen:                print(i, ': ', host[i])                i += 1        print(hostarr())        hostSelected = int(input("Enter the number corresponding to the host: "))        host = host[hostSelected]        print("Selected Host is:", host)        imap_url = host        M = imaplib.IMAP4_SSL(imap_url)        fillingsquaresbarr = fillingsquares("Verifying")        mailnotice = "Password verified"        rcolor(rcolors.blueok, mailnotice)        M.login(user, password)        M.select('INBOX')        typ, data = M.search(None, 'All')        chargingbarr = charging("Loading Data")        for num in data[0].split():            typ, data = M.fetch(num, '(RFC822)')            print('Message %s\n%s\n' % (num, data[0][1]))        M.close()        M.logout()        rcolor(rcolors.blueok, "Success")        print("Account {} logout".format(username))edata = Sendsmtp("test")